<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Especificación Producto Terminado</title>
    <link rel="stylesheet" href="../assets/css/DocumentoEspecs.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

</head>

<body>

    <div class="header" id="header">
        <div class="header-left">
            <img src="../assets/images/logo_reccius_medicina_especializada.png" alt="Logo" />
            <br>
            <div class="sub-info">
                Producto de recetario magistral <br>
                Res. Ex. N° 2988/2018 <br>
                RF XII 001/18: 1A, 1B, 2A, 2C, 3A, 3B, 3D, 4 y homeopático
            </div>
        </div>
        <div class="header-center">
            <h1>Especificación Producto Terminado</h1>
            Ácido Ascórbico 1g 10ml Amp <br>
            Dirección de Calidad
        </div>
        <div class="header-right">
            Doc No: CAL-CPF-007 <br>
            Edición: 24/07/2023 <br>
            Versión: 005 <br>
            Vigencia: 5 Años <br>
            Elab. por: QF DCA.LSR <br>
            Rev.Por: QF DTS.CPG <br>
            Aut.Por: QF DTL.ISM <br>
            Página: 1 de 2
        </div>
    </div>

    <div class="content" id="content">
        <button id="download-pdf" onclick="downloadPDF()">Descargar PDF</button>
        <!-- Resto del contenido del cuerpo igual al HTML original -->
        <div class="table-section">
            <div class="document-title">
                <h2>ESPECIFICACIONES DE PRODUCTO TERMINADO</h2>
                <h3>ÁCIDO ASCÓRBICO 1G 10ML AMPOLLA</h3>
            </div>
            <div class="analysis-section">
                I. Análisis Generales
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Análisis</th>
                        <th>Metodología</th>
                        <th>Criterio de Aceptación</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Apariencia</td>
                        <td>Interno</td>
                        <td class="criteria">Solución límpida, transparente, de color ligeramente amarillo, inolora, sin
                            partículas extrañas visibles en suspensión y contenida en una ampolla de vidrio ámbar.</td>
                    </tr>
                    <!-- Repite las filas según sea necesario para cada criterio de análisis -->
                    <tr>
                        <td>Identificación</td>
                        <td>USP</td>
                        <td>(A) La coloración azul se vuelve apreciablemente transparente o desaparece dentro de 3
                            minutos.
                            <br> (B) ...
                        </td>
                    </tr>
                    <!-- Más filas según el contenido de tu documento -->
                </tbody>
                <tbody>
                    <!-- Fila de Apariencia ya incluida -->

                    <!-- Fila de Identificación ya incluida -->

                    <!-- Fila de Valoración -->
                    <tr>
                        <td>Valoración</td>
                        <td>USP</td>
                        <td>10 g / 100ml (90 - 110%)</td>
                    </tr>

                    <!-- Fila de pH -->
                    <tr>
                        <td>pH</td>
                        <td>USP</td>
                        <td>5,5 - 7,0</td>
                    </tr>

                    <!-- Fila de Densidad -->
                    <tr>
                        <td>Densidad</td>
                        <td>Interno</td>
                        <td>1,0 - 1,1 g/mL</td>
                    </tr>

                    <!-- Fila de Osmolaridad -->
                    <tr>
                        <td>Osmolaridad</td>
                        <td>Interno</td>
                        <td>900 - 1100 Osm/Kg</td>
                    </tr>

                    <!-- Fila de Límite de Oxalato -->
                    <tr>
                        <td>Límite de Oxalato</td>
                        <td>USP</td>
                        <td>No se produce turbidez en 1 minuto</td>
                    </tr>

                    <!-- Fila de Volumen extraíble -->
                    <tr>
                        <td>Volumen extraíble</td>
                        <td>USP</td>
                        <td>No menor al declarado (10ml)</td>
                    </tr>

                    <!-- Fila de Material Sub particulado -->
                    <tr>
                        <td>Material Sub particulado</td>
                        <td>USP</td>
                        <td>Obturación: >10um: 6000 y >25um: 600 por ampolla Microscopía: >10um: 3000 y >25um: 300 por
                            ampolla</td>
                    </tr>

                    <!-- Fila de Material Particulado -->
                    <tr>
                        <td>Material Particulado</td>
                        <td>USP</td>
                        <td>Ausente</td>
                    </tr>
                </tbody>
            </table>
            </table>
        </div>
    </div>

    <div class="footer" id="footer">
        <!-- Sección realizada por -->
        <div class="footer-section">
            <div class="footer-box-title">Realizado por:</div>
            <div class="footer-box">
                <p class="bold">QF. Ingar Surname Rodríguez</p>
                <p class="bold">Director de Calidad</p>
                <div class="signature">[Espacio para la firma]</div>
                <p>Firmado digitalmente</p>
            </div>
            <div class="date">Fecha: 24/07/2023</div>
        </div>

        <!-- Sección revisada por -->
        <div class="footer-section">
            <div class="footer-box-title">Revisado por:</div>
            <div class="footer-box">
                <p class="bold">QF. Cathrine Pereira García</p>
                <p class="bold">Jefe de Producción</p>
                <p>Ausente por Licencia</p>
                <p>Firmado digitalmente</p>
            </div>
            <div class="date">Fecha: 24/07/2023</div>
        </div>

        <!-- Sección aprobada por -->
        <div class="footer-section">
            <div class="footer-box-title">Aprobado por:</div>
            <div class="footer-box">
                <p class="bold">QF. Luis Sepúlveda Miranda</p>
                <p class="bold">Director Técnico</p>
                <div class="signature">[Espacio para la firma]</div>
                <p>Firmado digitalmente</p>
            </div>
            <div class="date">Fecha: 24/07/2023</div>
        </div>
    </div>


    <script>
        window.onload = function () {
            document.getElementById('download-pdf').addEventListener('click', function () {
                downloadPDF();
            });
        };

        function downloadPDF() {
    // Asegúrese de que jsPDF esté cargado en el ámbito
    const { jsPDF } = window.jspdf;
    const contentElement = document.getElementById('content');
    const headerElement = document.getElementById('header');
    const footerElement = document.getElementById('footer');

    if (contentElement && headerElement && footerElement) {
        // Cree una nueva instancia de jsPDF
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'pt',
            format: 'a4'
        });

        // Calcule las posiciones y dimensiones
        const margin = 10; // Margen en puntos
        const pdfWidth = pdf.internal.pageSize.getWidth() - 2 * margin;
        const pdfHeight = pdf.internal.pageSize.getHeight();
        const headerHeight = 80; // Ajuste la altura en función de su encabezado
        const footerHeight = 60; // Ajuste la altura en función de su pie de página

        // Función para añadir contenido al PDF
        const addContentToPDF = (contentDataUrl) => {
            // Ajuste estas dimensiones según sea necesario
            const contentTopMargin = 80; // Ajuste en función de su encabezado
            const contentBottomMargin = 80; // Ajuste en función de su pie de página
            pdf.addImage(contentDataUrl, 'PNG', margin, contentTopMargin, pdfWidth, pdfHeight - contentTopMargin - contentBottomMargin);
        };

        // Función para añadir encabezado y pie de página al PDF
        const addHeaderFooterToPDF = (headerDataUrl, footerDataUrl) => {
            pdf.addImage(headerDataUrl, 'PNG', margin, margin, pdfWidth, headerHeight - margin);
            pdf.addImage(footerDataUrl, 'PNG', margin, pdfHeight - footerHeight, pdfWidth, footerHeight - margin);
        };

        // Renderice el encabezado, el contenido y el pie de página en canvas usando html2canvas
        Promise.all([
            html2canvas(headerElement, { scale: 2, useCORS: true }),
            html2canvas(contentElement, { scale: 2, useCORS: true }),
            html2canvas(footerElement, { scale: 2, useCORS: true })
        ]).then(canvases => {
            const [headerCanvas, contentCanvas, footerCanvas] = canvases;

            // Convierta los canvas a Data URLs
            const headerDataUrl = headerCanvas.toDataURL('image/png');
            const contentDataUrl = contentCanvas.toDataURL('image/png');
            const footerDataUrl = footerCanvas.toDataURL('image/png');

            // Añada el encabezado, el contenido y el pie de página al PDF
            addHeaderFooterToPDF(headerDataUrl, footerDataUrl);
            addContentToPDF(contentDataUrl);

            // Guarde el PDF
            pdf.save('especificacion-producto.pdf');
        }).catch(error => {
            console.error('Error al generar el PDF:', error);
        });
    } else {
        console.error('Uno o más elementos necesarios no están presentes en el DOM.');
    }
}

    </script>





</body>

</html>